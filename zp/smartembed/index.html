<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex">
    <title>Zoom Phone Smart Embed</title>
</head>
<body>
    <!-- Phone number links -->
    <ul>
        <li><a href="#" class="make-call" data-number="+81-90-2222-3333" data-ani="050-2222-3333">Call +81-90-2222-3333</a></li>
        <li><a href="#" class="make-call" data-number="+81-80-5555-5555" data-ani="+81-50-8888-8888">Call +81-80-5555-5555</a></li>
    </ul>

    <!-- Container for Zoom Phone Embed -->
    <div id="zoom-phone-container"></div>

    <script>
        // Load the Zoom Phone SDK
        const sdkScript = document.createElement('script');
        sdkScript.src = "https://vaapplicationscontent.zoom.us/phoneSdk/static/smart-embed/js/sdk.js";
        sdkScript.async = true;
        document.head.appendChild(sdkScript);

        sdkScript.onload = () => {
            console.log("Zoom Phone Smart Embed SDK loaded.");

            // Initialize the Zoom Phone Widget
            const zpWidget = ZoomPhone.createWidget({
                container: 'zoom-phone-container',
                configuration: {
                    enableSavingLog: false,
                    enableAutoLog: false,
                    enableContactSearching: false,
                    enableContactMatching: false,
                },
            });

            // Attach click handlers to make-call links
            document.querySelectorAll('.make-call').forEach((callLink) => {
                callLink.addEventListener('click', (event) => {
                    event.preventDefault();

                    const phoneNumber = callLink.dataset.number;
                    const ani = callLink.dataset.ani;

                    console.log("Attempting to call:", phoneNumber, "from ANI:", ani);

                    zpWidget.makeCall({
                        number: phoneNumber,
                        callerId: ani,
                        autoDial: true
                    }).then(() => {
                        console.log("Call successfully initiated.");
                    }).catch((error) => {
                        console.error("Error initiating call:", error);
                    });
                });
            });
        };

        sdkScript.onerror = () => {
            console.error("Failed to load Zoom Phone Smart Embed SDK.");
        };
    </script>
</body>
</html>
